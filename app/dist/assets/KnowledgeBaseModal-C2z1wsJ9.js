import{c as i,r as k,j as e,a as v,B}from"./index-DjhJUK_y.js";import{M as C}from"./Modal-DmPGCuwV.js";import{F as y}from"./file-text-CEektQ_P.js";import{T as M}from"./trash-2-dkXp1wAJ.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=i("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b=i("Clock3",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16.5 12",key:"1aq6pp"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=i("CloudUpload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=i("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]),U={pending:{label:"Pending",color:"yellow",icon:b},chunking:{label:"Chunking",color:"blue",icon:b},indexed:{label:"Indexed",color:"green",icon:S}},K=o=>{if(!o)return"0 B";const c=["B","KB","MB","GB"],a=Math.floor(Math.log(o)/Math.log(1024));return`${(o/1024**a).toFixed(1)} ${c[a]}`},E=({isOpen:o,onClose:c,documents:a,onUpload:f,onRemove:j,limitReached:d,maxDocuments:x,planDetails:t,onUpgradeClick:h})=>{var u;const[g,m]=k.useState(null),r=(((u=t==null?void 0:t.entitlements)==null?void 0:u.kbLimit)??0)>0,N=!r||x===void 0?"0":x===Number.POSITIVE_INFINITY?"∞":String(x),w=async s=>{var n;const l=(n=s.target.files)==null?void 0:n[0];if(l)try{await f(l),m(null)}catch(p){console.error("KB upload failed",p),m(p.message||"Upload failed. Please try again.")}finally{s.target.value=""}};return e.jsxs(C,{title:"Knowledge Base",description:"Upload your objection battlecards, pricing sheets, or interview playbooks. Ghost will ingest and surface the right snippet during live calls.",isOpen:o,onClose:c,footer:e.jsx("p",{className:"text-xs text-gray-500",children:"All files stay local until you wire up Pinecone/S3. This is a visual preview of the ingestion flow."}),children:[e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 mb-2",children:[e.jsxs("span",{children:["Plan: ",(t==null?void 0:t.label)??"Guest"]}),e.jsx("span",{children:r?`${a.length}/${N} docs used`:"Locked for guest tier"})]}),e.jsxs("label",{className:`border border-dashed rounded-2xl p-6 flex flex-col items-center justify-center text-center gap-3 transition-colors ${r&&!d?"cursor-pointer border-gray-700 hover:border-blue-500 hover:bg-blue-500/5":"border-gray-800 cursor-not-allowed bg-gray-900/50 opacity-60"}`,children:[e.jsx(T,{className:"w-10 h-10 text-blue-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-white",children:r?"Drop your docs here":"Upgrade to unlock Knowledge Base"}),e.jsx("p",{className:"text-xs text-gray-400",children:r?"PDF, Markdown, or TXT • max 5MB per file":t==null?void 0:t.upgradeCta})]}),e.jsx("input",{type:"file",className:"hidden",onChange:w,accept:".pdf,.md,.txt,.docx",disabled:!r||d})]}),(!r||d)&&e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-3 p-3 bg-gray-900/60 border border-gray-800 rounded-xl text-sm text-gray-300",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{className:"w-4 h-4 text-yellow-400"}),e.jsx("span",{children:r?"Document cap reached. Upgrade for more storage.":"Knowledge Base is available starting on the Trial plan."})]}),h&&e.jsx(v,{onClick:h,className:"text-xs px-3 py-1",children:"Upgrade"})]}),g&&e.jsx("div",{className:"p-3 bg-red-900/30 border border-red-700 rounded-lg text-sm text-red-200",children:g}),e.jsxs("div",{className:"space-y-3",children:[a.length===0&&e.jsxs("div",{className:"text-center py-10 bg-gray-900/40 rounded-2xl border border-gray-800",children:[e.jsx(y,{className:"w-8 h-8 mx-auto text-gray-700 mb-3"}),e.jsx("p",{className:"text-gray-400 text-sm",children:r?"No documents yet. Upload your first playbook to unlock RAG cues.":"Link your account to unlock Knowledge Base ingestion."})]}),a.map(s=>{const l=U[s.status],n=l.icon;return e.jsxs("div",{className:"flex items-start gap-3 p-4 bg-gray-900/70 border border-gray-800 rounded-xl",children:[e.jsx("div",{className:"p-2 rounded-lg bg-gray-800 text-blue-300",children:e.jsx(y,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-white truncate",title:s.name,children:s.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[K(s.size)," • ",new Date(s.createdAt).toLocaleString()]})]}),e.jsx("button",{type:"button",className:"text-gray-500 hover:text-red-400 transition-colors",onClick:()=>j(s.id),children:e.jsx(M,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[e.jsxs(B,{color:l.color,children:[e.jsx(n,{className:"w-3 h-3 inline mr-1"}),l.label]}),e.jsx("p",{className:"text-xs text-gray-500",children:s.status==="chunking"?"Splitting into semantic chunks...":s.status==="indexed"?"Ready for Pinecone search.":"Queued for ingestion."})]})]})]},s.id)})]})]})};export{E as KnowledgeBaseModal};
