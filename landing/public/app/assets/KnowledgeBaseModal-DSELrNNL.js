import{c as i,r as B,j as e,a as C,B as M}from"./index-zowQoAB2.js";import{M as U}from"./Modal-pcImM4mU.js";import{F as b}from"./file-text-BX-Lw-t1.js";import{T as I}from"./trash-2-D6oIrGYN.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=i("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j=i("Clock3",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16.5 12",key:"1aq6pp"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=i("CloudUpload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=i("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]),K={pending:{label:"Pending",color:"yellow",icon:j},chunking:{label:"Chunking",color:"blue",icon:j},indexed:{label:"Indexed",color:"green",icon:S}},c=a=>{if(!a||a===0)return"0 B";const d=["B","KB","MB","GB"],l=Math.floor(Math.log(a)/Math.log(1024));return`${(a/Math.pow(1024,l)).toFixed(1)} ${d[l]}`},L=({isOpen:a,onClose:d,documents:l,onUpload:N,onRemove:w,limitReached:x,maxSizeBytes:h,totalSize:m=0,planDetails:r,onUpgradeClick:u})=>{var y;const[g,p]=B.useState(null),s=(((y=r==null?void 0:r.entitlements)==null?void 0:y.kbSizeLimit)??0)>0,k=()=>!s||h===void 0?"0 B / 0 B":h===Number.POSITIVE_INFINITY?`${c(m)} / ∞`:`${c(m)} / ${c(h)}`,v=async t=>{var n;const o=(n=t.target.files)==null?void 0:n[0];if(o)try{await N(o),p(null)}catch(f){console.error("KB upload failed",f),p(f.message||"Upload failed. Please try again.")}finally{t.target.value=""}};return e.jsxs(U,{title:"Knowledge Base",description:"Upload your objection battlecards, pricing sheets, or interview playbooks. Ghost will ingest and surface the right snippet during live calls.",isOpen:a,onClose:d,footer:e.jsx("p",{className:"text-xs text-gray-500",children:"All files stay local until you wire up Pinecone/S3. This is a visual preview of the ingestion flow."}),children:[e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 mb-2",children:[e.jsxs("span",{children:["Plan: ",(r==null?void 0:r.label)??"Guest"]}),e.jsx("span",{children:s?k():"Locked for guest tier"})]}),e.jsxs("label",{className:`border border-dashed rounded-2xl p-6 flex flex-col items-center justify-center text-center gap-3 transition-colors ${s&&!x?"cursor-pointer border-gray-700 hover:border-blue-500 hover:bg-blue-500/5":"border-gray-800 cursor-not-allowed bg-gray-900/50 opacity-60"}`,children:[e.jsx(T,{className:"w-10 h-10 text-blue-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-white",children:s?"Drop your docs here":"Upgrade to unlock Knowledge Base"}),e.jsx("p",{className:"text-xs text-gray-400",children:s?"PDF, Markdown, or TXT • max 5MB per file":r==null?void 0:r.upgradeCta})]}),e.jsx("input",{type:"file",className:"hidden",onChange:v,accept:".pdf,.md,.txt,.docx",disabled:!s||x})]}),(!s||x)&&e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-3 p-3 bg-gray-900/60 border border-gray-800 rounded-xl text-sm text-gray-300",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(F,{className:"w-4 h-4 text-yellow-400"}),e.jsx("span",{children:s?"Storage limit reached. Upgrade for more capacity.":"Knowledge Base is available starting on the Free plan."})]}),u&&e.jsx(C,{onClick:u,className:"text-xs px-3 py-1",children:"Upgrade"})]}),g&&e.jsx("div",{className:"p-3 bg-red-900/30 border border-red-700 rounded-lg text-sm text-red-200",children:g}),e.jsxs("div",{className:"space-y-3",children:[l.length===0&&e.jsxs("div",{className:"text-center py-10 bg-gray-900/40 rounded-2xl border border-gray-800",children:[e.jsx(b,{className:"w-8 h-8 mx-auto text-gray-700 mb-3"}),e.jsx("p",{className:"text-gray-400 text-sm",children:s?"No documents yet. Upload your first playbook to unlock RAG cues.":"Link your account to unlock Knowledge Base ingestion."})]}),l.map(t=>{const o=K[t.status],n=o.icon;return e.jsxs("div",{className:"flex items-start gap-3 p-4 bg-gray-900/70 border border-gray-800 rounded-xl",children:[e.jsx("div",{className:"p-2 rounded-lg bg-gray-800 text-blue-300",children:e.jsx(b,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-white truncate",title:t.name,children:t.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[c(t.size)," • ",new Date(t.createdAt).toLocaleString()]})]}),e.jsx("button",{type:"button",className:"text-gray-500 hover:text-red-400 transition-colors",onClick:()=>w(t.id),children:e.jsx(I,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[e.jsxs(M,{color:o.color,children:[e.jsx(n,{className:"w-3 h-3 inline mr-1"}),o.label]}),e.jsx("p",{className:"text-xs text-gray-500",children:t.status==="chunking"?"Splitting into semantic chunks...":t.status==="indexed"?"Ready for Pinecone search.":"Queued for ingestion."})]})]})]},t.id)})]})]})};export{L as KnowledgeBaseModal};
